# 异步编程 - 单线程JavaScript异步方案

采用单线程模式工作的原因？

与最早的设计初衷有关，javaScript是运行在浏览器端的脚本语言，是用来实现页面上的动态交互，而实现页面上的动态交互的核心就是Dom操作，这就决定他必须使用单线程，否则就会出现很复杂的线程同步问题，试想一下，如果在javaScript线程当中有多个任务需要执行，其中一个线程修改了某一个dom元素，另外一个线程又删除了某一个Dom元素，那此时浏览器就不知道该以那一次的线程结果为准，所以为了避免这种类似的线程同步的问题，所以从一开始就规定好了采用单线程模式工作

JS执行环境中负责执行代码的线程只有一个，如果有多个任务，需要排队进行执行

这种方式的优点：更加安全，更加简单
这种方式的缺点：遇到耗时的任务就会导致假死的情况

为了解决以上的问题，javaScript将执行模式分为里两种

+ 同步任务（Synchronous）
+ 异步任务（Asynchronous）

所以我们需要掌握的知识具有一下几方面

+ 同步模式与异步模式
+ 事件循环与消息队列
+ 异步编程的几种方式
+ Promise异步方案、宏任务/微任务队列
+ Generator异步方案（ES2015）、Async/Await语法糖（ES2017）

## 同步模式 Synchronous

同步模式：多个任务等待执行的过程当中，后一个任务需要等待前一个任务执行完毕之后在执行，程序的执行顺序跟代码的顺序是一致的，同步不代表同时，而是排队执行，把全部的代码压入执行栈，放在一个匿名函数当中执行

# #异步模式 Asynchronous

异步模式： 不会等待这个任务的结束才开始下一个任务，一个任务执行开启过后立即往后执行下一个任务，耗时任务的后续逻辑一般会通过回调函数的方式定义，耗时任务执行完毕之后就会执行回掉函数，如果没有异步模式，单线程的javaScript语言就无法同时处理大量耗时任务。

JavaScript某一个时刻发起一个任务，异步线程会单独的执行这个异步任务，执行完毕之后会将这个任务放在消息队列当中，js主线程完成全部的任务过后，会在一次执行我们的消息队列当中的任务

![6-1](./6-1.png)

## 回调函数

回调函数可以理解为一件你想要做的事，但是你不知道这件事儿依赖的任务什么时候执行完，所以将这些行为封装成一个函数，当任务执行完毕之后在执行这些行为，即由调用者定义，交给执行者执行的函数就称为回调函数


